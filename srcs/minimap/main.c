/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   main.c                                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: knakto <knakto@student.42bangkok.com>      +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/06/04 04:05:15 by knakto            #+#    #+#             */
/*   Updated: 2025/06/04 18:53:09 by knakto           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "MLX42.h"
#include "minimap.h"
#include "cube.h"

mlx_image_t	*put_map(mlx_t *mlx)
{
	int				i;
	int				j;
	mlx_texture_t	*minimap_t;
	mlx_image_t		*minimap_i;
	t_map_pos		***map;

	i = 0;
	map = *get_t_map();
	minimap_t = new_texture(100, 100, 0xdddddd);
	while (map[i])
	{
		j = 0;
		while (map[i][j])
		{
			if (map[i][j]->type == WALL)
				ft_texture(minimap_t, map[i][j]->x + 30, map[i][j]->y + 30, 0x000000);
			else if (map[i][j]->type == FLOOR)
				ft_texture(minimap_t, map[i][j]->x + 30, map[i][j]->y + 30, 0xaaaaaa);
			j++;
		}
		i++;
	}
	ft_texture(minimap_t, get_t_player()->x + 30, get_t_player()->y + 30, 0xff0000);
	minimap_i = mlx_texture_to_image(mlx, minimap_t);
	mlx_delete_texture(minimap_t);
	return (minimap_i);
}

void	start_mlx(void)
{
	mlx_t			*mlx;
	mlx_image_t		*img;
	mlx_image_t		*minimap_i;
	mlx_texture_t	*texture;
	int				i;
	int				j;

	mlx = mlx_init(WIDTH, HEIGHT, "game", true);
	texture = new_texture(WIDTH, HEIGHT, 0xFFFFFF);
	img = mlx_texture_to_image(mlx, texture);
	minimap_i = put_map(mlx);
	mlx_image_to_window(mlx, img, 0, 0);
	mlx_image_to_window(mlx, minimap_i, 0, 0);
	mlx_loop(mlx);
	mlx_terminate(mlx);
}

int	main(void)
{
	t_map_pos	***map;

	addmap("\
11111111111111111111111111111111111111\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000110000000000000000001\n\
10000000000000000110000000000000000001\n\
10000000000000000110000000000000000001\n\
10000000000000000110000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
100000000000000000p0000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
10000000000000000000000000000000000001\n\
11111111111111111111111111111111111111");
	print();
	start_mlx();
}
